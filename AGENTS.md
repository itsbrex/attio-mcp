# Agents.md Guide for OpenAI Codex and AI Assistants

This Agents.md file provides comprehensive guidance for OpenAI Codex and other AI agents working with the Attio MCP Server codebase.

## Project Structure for OpenAI Codex Navigation

- `/src`: Source code that OpenAI Codex should analyze and modify
  - `/api`: Attio API client and operations that OpenAI Codex can extend
  - `/handlers`: MCP tool handlers and configurations for OpenAI Codex to understand
  - `/objects`: Business logic for companies, people, lists that Agents.md helps OpenAI Codex navigate
  - `/prompts`: MCP prompt templates where OpenAI Codex can add new prompts
  - `/types`: TypeScript type definitions that OpenAI Codex should maintain
  - `/utils`: Utility functions that Agents.md documents for OpenAI Codex
  - `/validators`: Input validation logic for OpenAI Codex to follow
- `/test`: Test files that OpenAI Codex should maintain and extend (Jest framework)
- `/docs`: Documentation that OpenAI Codex should keep updated
- `/scripts`: Setup and utility scripts that OpenAI Codex can improve
- `/dist`: Compiled JavaScript output (OpenAI Codex should not modify directly)

## Key Technologies for OpenAI Codex Understanding

- **Language**: TypeScript (strict mode) - OpenAI Codex must follow strict typing
- **Runtime**: Node.js 18+ - OpenAI Codex should use modern Node.js features
- **Framework**: Model Context Protocol SDK - Agents.md requires MCP compliance
- **Testing**: Jest with ts-jest - OpenAI Codex should write comprehensive tests
- **Build**: TypeScript compiler (tsc) - OpenAI Codex should ensure compilation succeeds

## Coding Conventions for OpenAI Codex

### TypeScript Standards for Agents.md Implementation

- OpenAI Codex must use strict TypeScript configuration
- Prefer interfaces over types for object definitions in OpenAI Codex code
- OpenAI Codex should use explicit return types for functions
- Agents.md requires following existing naming conventions:
  - `PascalCase` for classes and interfaces in OpenAI Codex output
  - `camelCase` for functions and variables in OpenAI Codex code
  - `snake_case` for file names when OpenAI Codex creates new files

### Code Organization Guidelines for OpenAI Codex

- Keep functions generated by OpenAI Codex focused on single responsibility
- OpenAI Codex must use proper error handling with try/catch blocks
- Agents.md requires import order: Node.js modules → external packages → internal modules
- OpenAI Codex should export functions and types explicitly

### Error Handling Standards for OpenAI Codex

- OpenAI Codex must use detailed error messages for API interactions
- Implement `createErrorResult` for consistent error responses in OpenAI Codex code
- OpenAI Codex should allow continuation on non-critical errors when appropriate
- Agents.md requires logging critical errors with `console.error`

## MCP Integration Requirements for OpenAI Codex

- OpenAI Codex must follow MCP protocol specifications strictly
- Use JSON-RPC 2.0 for tool definitions in OpenAI Codex implementations
- **CRITICAL**: OpenAI Codex must NEVER use `oneOf`, `allOf`, `anyOf` at top level of tool schemas
- Agents.md requires handling tool parameter validation in runtime code, not schemas
- OpenAI Codex should reference docs/mcp-schema-guidelines.md for compliance

## Testing Requirements for OpenAI Codex

OpenAI Codex should run tests with the following commands:

```bash
# Run all tests with OpenAI Codex
npm test

# Run specific test pattern with OpenAI Codex
npm test -- -t "test name pattern"

# Run offline tests for restricted environments
npm run test:offline

# Run integration tests with OpenAI Codex
npm test -- integration/real-api-integration.test.ts
```

### Test Standards for OpenAI Codex

- **CRITICAL**: OpenAI Codex must place ALL tests in `/test` directory - never in project root
- Use `.test.ts` suffix for TypeScript tests in OpenAI Codex
- Manual test scripts should use `-test.js` suffix when created by OpenAI Codex
- Agents.md requires test files mirror the structure of source code they test

## Build and Development Commands for OpenAI Codex

```bash
# Build commands for OpenAI Codex
npm run build              # Compile TypeScript
npm run build:watch        # Watch mode compilation
npm run check              # Type checking
npm run clean              # Remove dist directory

# Codex-specific commands
npm run codex:setup        # Setup Codex environment
npm run codex:verify       # Verify environment
npm run test:offline       # Run tests without network
npm run check:offline      # Type check without network
```

## Environment Setup for OpenAI Codex

- OpenAI Codex must set `ATTIO_API_KEY` and `ATTIO_WORKSPACE_ID` environment variables
- Use `.env` files for local development in OpenAI Codex workflows
- **CRITICAL**: OpenAI Codex must NEVER commit API keys or secrets
- Agents.md requires using `process.env.ATTIO_API_KEY` in OpenAI Codex code

## Commit Message Format for OpenAI Codex

OpenAI Codex must use these exact prefixes:
- `Feature:` - New functionality
- `Fix:` - Bug fixes  
- `Docs:` - Documentation changes
- `Refactor:` - Code restructuring
- `Test:` - Test additions/modifications
- `Chore:` - Routine maintenance

## Attribution Rules for OpenAI Codex

**CRITICAL REQUIREMENTS**:
- OpenAI Codex must NEVER include "Generated with Claude Code" or similar messages
- OpenAI Codex must NEVER add "Co-Authored-By: Claude" or AI assistant attributions
- ALL work by OpenAI Codex should appear as if done directly by the human developer
- Agents.md requires removing ALL AI assistant signatures from generated text
- NO automated footers, signatures, or attribution messages of any kind

## Pull Request Guidelines for OpenAI Codex

When OpenAI Codex helps create a PR, Agents.md requires:

1. Clear description of changes implemented by OpenAI Codex
2. Reference related issues that OpenAI Codex is addressing
3. Ensure all tests pass for code generated by OpenAI Codex
4. Keep PRs focused on single concern as specified in Agents.md
5. Follow project's GitHub workflow requirements

## Programmatic Checks for OpenAI Codex

Before submitting changes generated by OpenAI Codex, run:

```bash
# Required checks for OpenAI Codex code
npm run build              # Build check
npm run check              # Type check
npm test                   # Test check
npm run lint:check         # Lint check (if available)
npm run check:format       # Format check (if available)
```

All checks must pass before OpenAI Codex generated code can be merged. Agents.md ensures OpenAI Codex follows these requirements.

## Security Considerations for OpenAI Codex

- OpenAI Codex must validate all external inputs
- Use environment variables for API keys in OpenAI Codex implementations
- OpenAI Codex must never log sensitive information
- Agents.md requires implementing proper rate limiting for API calls

## Performance Guidelines for OpenAI Codex

- OpenAI Codex should use efficient data structures for large datasets
- Implement pagination for list operations in OpenAI Codex code
- OpenAI Codex should cache responses when appropriate
- Agents.md requires minimizing API calls through batching

## File Modification Guidelines for OpenAI Codex

- OpenAI Codex must verify file structure matches current project layout
- Check imports and dependencies before OpenAI Codex modifies files
- OpenAI Codex should use existing utility functions rather than creating duplicates
- Agents.md requires following established patterns in similar files

## Integration Testing Setup for OpenAI Codex

- Set up API key: `export ATTIO_API_KEY=your_key_here` for OpenAI Codex
- Tests use real API calls with 30s timeout in OpenAI Codex test runs
- Tests clean up test data automatically when run by OpenAI Codex
- Skip tests if no API key: `SKIP_INTEGRATION_TESTS=true`

## Important Notes for OpenAI Codex

- This project uses ES modules (`type: "module"` in package.json)
- OpenAI Codex must use `.js` extensions in imports (TypeScript requirement)
- The server runs as MCP server, not web server for OpenAI Codex understanding
- Main entry point is `dist/index.js` after compilation by OpenAI Codex
- OpenAI Codex should reference `TROUBLESHOOTING.md` for common issues